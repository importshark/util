{"version":3,"sources":["../../../src/components/asset/asset.ts"],"names":["Asset","from","child","parent","hash","size","path","Error","constructor","subhash","substring","legacyPath","objectPath","toArtifact","legacy","repoURL","MOJANG","RESOURCE_REPO","Artifact","toString","toJSON"],"mappings":";;;;;;;AACA;;AACA;;AACA;;AAQO,MAAMA,KAAN,CAAY;AAEJ,SAAJC,IAAI,CAACC,KAAD,EAAuCC,MAAvC,EAAwE;AAC/E,QAAI,CAACA,MAAL,EAAa;AACT,UAAID,KAAK,YAAYF,KAArB,EAA4B,OAAOE,KAAP;AAC5BC,MAAAA,MAAM,GAAG,EAAT;AACH;;AAED,UAAM;AACFC,MAAAA,IAAI,GAAGD,MAAM,CAACC,IADZ;AAEFC,MAAAA,IAAI,GAAGF,MAAM,CAACE;AAFZ,QAGFH,KAHJ;AAKA,QAAI,CAACC,MAAM,CAACG,IAAZ,EAAkB,MAAM,IAAIC,KAAJ,CAAU,2BAAV,CAAN;AAClB,QAAI,CAACH,IAAL,EAAW,MAAM,IAAIG,KAAJ,CAAU,oBAAV,CAAN;AACX,QAAI,CAACF,IAAL,EAAW,MAAM,IAAIE,KAAJ,CAAU,oBAAV,CAAN;AAEX,WAAO,IAAIP,KAAJ,CACHG,MAAM,CAACG,IADJ,EAEHF,IAFG,EAGHC,IAHG,CAAP;AAKH;;AAEDG,EAAAA,WAAW,CACAF,IADA,EAEAF,IAFA,EAGAC,IAHA,EAIT;AAAA,SAHSC,IAGT,GAHSA,IAGT;AAAA,SAFSF,IAET,GAFSA,IAET;AAAA,SADSC,IACT,GADSA,IACT;AAAG;AAEL;AACJ;AACA;;;AACe,MAAPI,OAAO,GAAW;AAClB,WAAO,KAAKL,IAAL,CAAUM,SAAV,CAAoB,CAApB,EAAuB,CAAvB,CAAP;AACH;AAED;AACJ;AACA;;;AACkB,MAAVC,UAAU,GAAW;AACrB,WAAO,gBAAK,SAAL,EAAgB,QAAhB,EAA0B,KAAKL,IAA/B,CAAP;AACH;AAED;AACJ;AACA;;;AACkB,MAAVM,UAAU,GAAW;AACrB,WAAO,gBAAK,SAAL,EAAgB,KAAKH,OAArB,EAA8B,KAAKL,IAAnC,CAAP;AACH;;AAEDS,EAAAA,UAAU,CAACC,MAAM,GAAG,KAAV,EAAiBC,OAAO,GAAGC,kBAAOC,aAAlC,EAA2D;AACjE,WAAO,IAAIC,kBAAJ,CACHJ,MAAM,GAAG,KAAKH,UAAR,GAAqB,KAAKC,UAD7B,EAEF,GAAEG,OAAQ,IAAG,KAAKN,OAAQ,IAAG,KAAKL,IAAK,EAFrC,EAGH,KAAKC,IAHF,EAIH,KAAKD,IAJF,CAAP;AAMH;;AAEDe,EAAAA,QAAQ,GAAW;AACf,WAAO,KAAKR,UAAZ;AACH;;AAEDS,EAAAA,MAAM,GAAyB;AAC3B,UAAM;AACFhB,MAAAA,IADE;AAEFC,MAAAA;AAFE,QAGF,IAHJ;AAIA,WAAO;AACHD,MAAAA,IADG;AAEHC,MAAAA;AAFG,KAAP;AAIH;;AAzEc","sourcesContent":["\nimport { MOJANG } from '../../constants';\nimport { join } from 'path';\nimport { Artifact } from '../artifact';\n\nexport interface IAsset {\n    path: string;\n    hash: string;\n    size: number;\n}\n\nexport class Asset {\n\n    static from(child: Omit<Partial<IAsset>, 'path'>, parent?: Partial<IAsset>): Asset {\n        if (!parent) {\n            if (child instanceof Asset) return child;\n            parent = {};\n        }\n\n        const {\n            hash = parent.hash,\n            size = parent.size,\n        } = child;\n\n        if (!parent.path) throw new Error('missing parent asset path');\n        if (!hash) throw new Error('missing asset hash');\n        if (!size) throw new Error('missing asset size');\n\n        return new Asset(\n            parent.path,\n            hash,\n            size,\n        );\n    }\n\n    constructor(\n        public path: string,\n        public hash: string,\n        public size: number,\n    ) { }\n\n    /**\n     * The first 2 hex letters of hash.\n     */\n    get subhash(): string {\n        return this.hash.substring(0, 2);\n    }\n\n    /**\n     * The legacy path. It should look like `virtual/legacy/<path>`, e.g. `virtual/legacy/lang/ru_RU.lang`.\n     */\n    get legacyPath(): string {\n        return join('virtual', 'legacy', this.path);\n    }\n\n    /**\n     * The object path. It should look like `objects/<subhash>/<hash>`, e.g. `objects/00/00..b8f`.\n     **/\n    get objectPath(): string {\n        return join('objects', this.subhash, this.hash);\n    }\n\n    toArtifact(legacy = false, repoURL = MOJANG.RESOURCE_REPO): Artifact {\n        return new Artifact(\n            legacy ? this.legacyPath : this.objectPath,\n            `${repoURL}/${this.subhash}/${this.hash}`,\n            this.size,\n            this.hash,\n        );\n    }\n\n    toString(): string {\n        return this.legacyPath;\n    }\n\n    toJSON(): Omit<IAsset, 'path'> {\n        const {\n            hash,\n            size,\n        } = this;\n        return {\n            hash,\n            size,\n        };\n    }\n\n}\n"],"file":"asset.js"}